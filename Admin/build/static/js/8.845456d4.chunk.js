(this.webpackJsonpetc_admin=this.webpackJsonpetc_admin||[]).push([[8],{602:function(e,t,a){"use strict";a.r(t);var r=a(28),n=a(4),c=a(0),i=a.n(c),s=a(107),o=Object(c.createContext)({}),l=function(e){var t=Object(c.useState)(!1),a=Object(r.a)(t,2),i=a[0],s=a[1],l=Object(c.useState)(""),u=Object(r.a)(l,2),d=u[0],j=u[1];return Object(c.useEffect)((function(){j("")}),[]),Object(n.jsx)(o.Provider,{value:[i,s,d,j],children:e.children})},u=a(601),d=a(64),j=a(60),b=a.n(j),p=a(87),f=a(394),m=a(605),h=a(54),O=(a(241),function(e){var t;return t=[],e.forEach((function(e){t.push(Object(d.a)(Object(d.a)({},e.data()),{},{key:e.id}))})),t}),v=function(e){return Promise.resolve({data:e.empty?[]:O(e),lastDoc:e.empty?null:e.docs[e.docs.length-1]})},x=function(e){return Promise.reject(e)};function g(e,t){return y.apply(this,arguments)}function y(){return(y=Object(p.a)(b.a.mark((function e(t,a){var r,n,c=arguments;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.length>2&&void 0!==c[2]?c[2]:void 0,n=c.length>3?c[3]:void 0,e.abrupt("return",void 0!==r?h.a.firestore().collection(t).where(n.fieldPath,"array-contains",n.value).orderBy(a.fieldPath,a.direction).startAfter(r).limit(10).get().then(v).catch(x):h.a.firestore().collection(t).where(n.fieldPath,"array-contains",n.value).orderBy(a.fieldPath,a.direction).limit(20).get().then(v).catch(x));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var k=a(594),w=function(e){var t=[],a="";return e.split("").forEach((function(e){a+=e,t.push(a)})),t},S=function(e){var t=[],a=e.toLowerCase().split(" ");for(var r in a)t.push.apply(t,Object(k.a)(w(a.slice(Number(r),a.length).join(" "))));return Object(k.a)(new Set([""].concat(t)))},L=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";function a(){return localStorage.getItem(e)}function r(){localStorage.setItem(e,t)}function n(){"all"===e?localStorage.clear():localStorage.removeItem(e)}return{get:a,store:r,destroy:n}},C=function(e){return e.map((function(e,t){return Object(d.a)(Object(d.a)({},e),{},{no:t+1})}))};var U=function(e,t,a){return h.a.firestore().collection(e).doc(t).update(Object(d.a)(Object(d.a)({},a),{},{createdAt:h.a.firestore.FieldValue.serverTimestamp()}))};var I=function(e,t){return h.a.firestore().collection(e).doc(t).delete()};var P=function(e,t){return h.a.firestore().collection(e).add(Object(d.a)(Object(d.a)({},t),{},{createdAt:h.a.firestore.FieldValue.serverTimestamp()}))},R=a(161);var D=function(e){var t=Object(c.useContext)(o),a=Object(r.a)(t,3),n=a[1],i=a[2],s=Object(c.useState)(!1),l=Object(r.a)(s,2),u=l[0],j=l[1],h=Object(c.useState)([]),O=Object(r.a)(h,2),v=O[0],x=O[1],y=Object(c.useState)(),k=Object(r.a)(y,2),w=k[0],D=k[1],F=Object(c.useCallback)((function(){null===e||void 0===e||e.resetFields(),L(window.location.pathname).destroy(),n(!1),j(!1)}),[e,n]),N=Object(c.useCallback)(Object(p.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,j(!0),e.next=4,g("cats",{fieldPath:"createdAt",direction:"desc"},void 0,{fieldPath:"keywords",value:i});case 4:t=e.sent,x(C(t.data)),D(t.lastDoc),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),f.a.error({message:e.t0.message,description:e.t0.description});case 12:return e.prev=12,j(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[0,9,12,15]])}))),[i]),A=Object(c.useCallback)(Object(p.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,j(!0),e.next=4,g("cats",{fieldPath:"createdAt",direction:"desc"},w,{fieldPath:"keywords",value:i});case 4:t=e.sent,x((function(e){return C(e.concat(t.data))})),D(t.lastDoc),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),f.a.error({message:e.t0.message,description:e.t0.description});case 12:return e.prev=12,j(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[0,9,12,15]])}))),[w,i]),T=Object(c.useCallback)(function(){var e=Object(p.a)(b.a.mark((function e(t){var a,r,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,j(!0),r=null===(a=t.imageURL)||void 0===a?void 0:a.file,n="".concat(r.uid,"-").concat(r.name),e.next=6,Object(R.a)("/cats/".concat(n),r);case 6:return delete t.imageURL,e.next=9,P("cats",Object(d.a)(Object(d.a)({},t),{},{imageURL:"https://storage.googleapis.com/scotish-fold.appspot.com/cats/".concat(n),keywords:S("".concat(t.title,"  ").concat(t.isSoldOut))}));case 9:f.a.success({message:"Listing berhasil ditambahkan"}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),f.a.error({message:e.t0.message,description:e.t0.description});case 15:return e.prev=15,e.next=18,N();case 18:return F(),e.finish(15);case 20:case"end":return e.stop()}}),e,null,[[0,12,15,20]])})));return function(t){return e.apply(this,arguments)}}(),[N,F]),z=Object(c.useCallback)(function(){var e=Object(p.a)(b.a.mark((function e(t,a){var r,n,c,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,j(!0),!(null===(r=a.imageURL)||void 0===r?void 0:r.file.isPath)){e.next=8;break}return delete a.imageURL,e.next=6,U("cats",t,Object(d.a)(Object(d.a)({},a),{},{keywords:S("".concat(a.title," ").concat(a.isSoldOut))}));case 6:e.next=15;break;case 8:return c=null===(n=a.imageURL)||void 0===n?void 0:n.file,i="".concat(c.uid,"-").concat(c.name),e.next=12,Object(R.a)("/cats/".concat(i),c);case 12:return delete a.imageURL,e.next=15,U("cats",t,Object(d.a)(Object(d.a)({},a),{},{imageURL:"https://storage.googleapis.com/scotish-fold.appspot.com/cats/".concat(i),keywords:S("".concat(a.title," ").concat(a.isSoldOut))}));case 15:f.a.success({message:"Listing berhasil diperbarui."}),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),f.a.error({message:e.t0.message,description:e.t0.description});case 21:return e.prev=21,e.next=24,N();case 24:return F(),e.finish(21);case 26:case"end":return e.stop()}}),e,null,[[0,18,21,26]])})));return function(t,a){return e.apply(this,arguments)}}(),[N,F]),B=Object(c.useCallback)(function(){var e=Object(p.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:m.a.confirm({title:"Apa anda yakin menghapus listing ini?",okText:"Ya, saya yakin",cancelText:"Batal",icon:null,centered:!0,onOk:function(){var e=Object(p.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,j(!0),e.next=4,I("cats",t);case 4:f.a.success({message:"Listing berhasil dihapus."}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),f.a.error({message:e.t0.message,description:e.t0.description});case 10:return e.prev=10,e.next=13,N();case 13:return j(!1),e.finish(10);case 15:case"end":return e.stop()}}),e,null,[[0,7,10,15]])})));return function(){return e.apply(this,arguments)}}()});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[N]);return Object(c.useEffect)((function(){N()}),[N]),[u,v,A,T,z,B]},F=a(608),N=a(606),A=a(395),T=a(609),z=function(){var e=Object(c.useContext)(o),t=Object(r.a)(e,4),a=t[1],i=t[3];return Object(n.jsx)("div",{className:"action-container",children:Object(n.jsx)("div",{className:"action-section",children:Object(n.jsxs)(F.b,{children:[Object(n.jsx)(N.a.Search,{placeholder:"Cari...",onSearch:function(e){return i(e)}}),Object(n.jsx)(A.a,{type:"primary",shape:"circle",onClick:function(){a(!0)},children:Object(n.jsx)(T.a,{})})]})})})},B=Object(c.memo)(z),E=a(600),J=a(451),q=a(610),M=function(e){var t=e.isLoading,a=e.form,i=e.updateData,s=e.createData,l=Object(c.useContext)(o),d=Object(r.a)(l,2),j=d[0],b=d[1],p=L(window.location.pathname).get();return Object(n.jsx)(m.a,{title:null,centered:!0,closable:!1,visible:j,footer:null,className:"cats-modal-container",children:Object(n.jsxs)(u.a,{layout:"vertical",form:a,onFinish:function(e){return p?i(p,e):s(e)},children:[Object(n.jsx)(u.a.Item,{shouldUpdate:!0,noStyle:!0,children:function(e){var t,a;return Object(n.jsx)(u.a.Item,{label:"Gambar",name:"imageURL",rules:[{required:!0,message:"Gambar wajib diisi!"},function(){return{validator:function(e,t){return["image/jpg","image/jpeg","image/png"].includes(null===t||void 0===t?void 0:t.file.type)?Promise.resolve():Promise.reject(new Error("File harus berupa gambar."))}}}],children:Object(n.jsx)(E.a,{style:{width:"100%"},fileList:[],beforeUpload:function(){return!1},children:Object(n.jsx)("div",{className:"image-form",children:Object(n.jsxs)(F.b,{children:[Object(n.jsx)(A.a,{type:"default",icon:Object(n.jsx)(q.a,{}),ghost:!1,shape:"circle",size:"small"}),null===(t=e.getFieldValue("imageURL"))||void 0===t||null===(a=t.file)||void 0===a?void 0:a.name]})})})})}}),Object(n.jsx)(u.a.Item,{label:"Judul",name:"title",rules:[{required:!0,message:"Judul wajib diisi!"}],children:Object(n.jsx)(N.a,{size:"large"})}),Object(n.jsx)(u.a.Item,{label:"Status",name:"isSoldOut",rules:[{required:!0,message:"Status akun wajin diisi."}],children:Object(n.jsxs)(J.a,{size:"large",children:[Object(n.jsx)(J.a.Option,{value:"terjual",children:"Terjual"}),Object(n.jsx)(J.a.Option,{value:"belum",children:"Belum Terjual"})]})}),Object(n.jsx)(u.a.Item,{label:"Deskripsi",name:"description",rules:[{required:!0,message:"Deskripsi wajib diisi!"}],children:Object(n.jsx)(N.a.TextArea,{})}),Object(n.jsx)(u.a.Item,{children:Object(n.jsx)("div",{style:{textAlign:"right"},children:Object(n.jsxs)(F.b,{children:[Object(n.jsx)(A.a,{size:"large",type:"default",onClick:function(){a.resetFields(),b(!1),L(window.location.pathname).destroy()},disabled:t,children:"Batal"}),Object(n.jsx)(A.a,{size:"large",type:"primary",htmlType:"submit",loading:t,children:"Simpan"})]})})})]})})},V=i.a.memo(M),G=a(603),_=a(397),W=a(599),Y=a(611),H=a(612),K=a(613),Q=a(556),X=a.n(Q),Z=function(e){var t=e.isLoading,a=e.datasource,i=e.loadMoreData,s=e.form,l=e.deleteData,u=Object(c.useContext)(o),j=Object(r.a)(u,2)[1],f=[{title:"No",dataIndex:"no",key:"no"},{title:"Gambar",dataIndex:"imageURL",key:"imageURL",render:function(e){return Object(n.jsx)("div",{style:{width:100,overflow:"hidden",borderRadius:10},children:Object(n.jsx)(G.a,{style:{cursor:"pointer"},wrapperStyle:{objectFit:"cover"},src:e,alt:""})})}},{title:"Judul",dataIndex:"title",key:"title"},{title:"Status",dataIndex:"isSoldOut",key:"isSoldOut"},{title:"Deskripsi",dataIndex:"description",key:"description"},{title:"",dataIndex:"key",key:"key",fixed:"right",width:100,render:function(e,t){return Object(n.jsxs)(F.b,{children:[Object(n.jsx)(A.a,{type:"primary",shape:"circle",ghost:!0,onClick:function(){var a=Object(d.a)(Object(d.a)({},t),{},{imageURL:{file:{name:t.imageURL,isPath:!0,type:"image/jpg"}}});s.setFieldsValue(a),L(window.location.pathname,e).store(),j(!0)},children:Object(n.jsx)(Y.a,{})}),Object(n.jsx)(A.a,{type:"primary",shape:"circle",ghost:!0,danger:!0,onClick:Object(p.a)(b.a.mark((function t(){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l(e);case 2:case"end":return t.stop()}}),t)}))),children:Object(n.jsx)(H.a,{})})]})}}];return Object(n.jsx)(_.a,{spinning:t,indicator:Object(n.jsx)(K.a,{style:{fontSize:24},spin:!0}),children:Object(n.jsx)("div",{className:"list-container",style:{padding:0},children:Object(n.jsx)(X.a,{initialLoad:!1,pageStart:0,loadMore:i,hasMore:!t,useWindow:!1,children:Object(n.jsx)("div",{className:"user-list",children:Object(n.jsx)(W.a,{dataSource:a,columns:f,pagination:!1})})})})})},$=Object(c.memo)(Z),ee=function(){var e=u.a.useForm(),t=Object(r.a)(e,1)[0],a=D(t),c=Object(r.a)(a,6),i=c[0],o=c[1],l=c[2],d=c[3],j=c[4],b=c[5];return Object(n.jsx)(s.a.Layout,{children:Object(n.jsxs)("section",{className:"main-cats",children:[Object(n.jsx)(B,{}),Object(n.jsx)(V,{isLoading:i,form:t,updateData:j,createData:d}),Object(n.jsx)($,{isLoading:i,datasource:o,loadMoreData:l,deleteData:b,form:t})]})})};t.default=function(){return Object(n.jsx)(l,{children:Object(n.jsx)(ee,{})})}}}]);
//# sourceMappingURL=8.845456d4.chunk.js.map